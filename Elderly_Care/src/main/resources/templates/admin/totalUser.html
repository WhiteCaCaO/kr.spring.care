<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/adminLayout}">

<div layout:fragment="content" class="content">
	<!-- Navigation-->
<nav class="navbar navbar-expand-lg navbar-light bg-light">

</nav>

<div class="container-fluid mt-3">
    <div class="row">
        <main class="col-md-12">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="h2" th:text="'회원관리('+ ${userCnt} +'/'+ ${AlluserCnt} +')'">회원관리</h1>
            </div>
            <div class="table-responsive">
                <table class="table table-striped table-sm">
                    <thead>
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Name</th>
                        <th scope="col">UserEmail</th>
                        <th scope="col">Created_at</th>
                        <!-- <th scope="col">Agree_Event</th> -->
                        <th scope="col">Role</th>
                        <th scope="col">UpdateRole</th>
                        <th scope="col">Update</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="user : ${allUser.content}">
                        <form th:action="@{/admin/authChange/{id}(id=${user.id})}" method="post" class="d-flex">
                            <td th:text="${user.id}">1</td>
                            <td th:text="${user.name}">name</td>
                            <td th:text="${user.email}">email</td>
                            <td th:text="${user.createdAt}">created_at</td>
                            <!-- <td th:text="${user.isAgreeEvent()}">agree_event</td> -->
                            <td th:text="${user.role}">role</td>
                            <td>    
                                <select name="role">
                                    <option value="USER">USER</option>
                                    <option value="CAREGIVER">CAREGIVER</option>
                                </select>
                            </td>
                            <td>
                                <button class="btn btn-outline-dark flex-shrink-0" type="submit">
                                    업데이트
                                </button>
                            </td>
                        </form>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="d-flex justify-content">
            <!-- 페이징 -->
	            <a th:href="@{/admin/totUser(page=1)}">첫 페이지</a>
	            <a th:href="${allUser.first} ? '#' : @{/admin/totUser(page=${allUser.number})}">이전</a>
	            <span th:each="page: ${#numbers.sequence(startPage, endPage)}">
	            	<span th:if="${page == allUser.number + 1}" th:text="${page}"></span>
	            	<span th:unless="${page == allUser.number + 1}">
	            		<a th:href="@{/admin/totUser(page=${page})}" th:text="${page}"></a>
	            	</span>
	            </span>
	            <a th:href="${allUser.last} ? '#' : @{/admin/totUser(page=${allUser.number + 2})}">다음</a>
	            <a th:href="@{/admin/totUser(page=${allUser.totalPages})}">마지막 페이지</a>
                
                <form class="d-flex justify-content-between" action="/admin/totUser" method="get">
                	<select class="form-select form-select" name="field">
                		<option value="name">이름</option>
                		<option value="email">이메일</option>
                	</select>
                	<input type="text" class="form-control" name="word" placeholder="글자를 입력하세요">
                	<button class="btn btn-secondary btn-sm">검색</button>
                </form>
            </div> 
            
            <!-- 모달 -->
            <div class="modal fade" id="viewModal" tabindex="-1"
              aria-labelledby="viewModalLabel" aria-hidden="true" th:fragments="modalContents"
              >
            	<div class="modal-dialog">
            		<div class="modal-content">
            			
            			<!-- 모달 header -->
            			<div class="modal-header">
            				<h5 class="modal-title" id="viewModalLabel">상세정보</h5>
            				<button type="button" class="btn-close" data-bs-dismiss="modal"
            				  aria-label="Close"></button>
            			</div>
            			<!-- 모달 body -->
            			<div class="modal-body" style="text-align:center;">
	                        <p>#</p>
	                        <p th:text="${person.name}">Name </p>
	                        <p>UserEmail</p>
	                        <p>Created_at</p>
	                        <p>Role</p>
	                        <p>UpdateRole</p>
	                        <p>Update</p>
	                        <!-- <form th:action="@{/admin/authChange/{id}(id=${user.id})}" method="post" class="d-flex">
	                            <td th:text="${user.id}">1</td>
	                            <td><a href="#" th:text="${user.name}" 
	                            	data-bs-toggle="modal" data-bs-target="#viewModal"></a></td>
	                            <td th:text="${user.email}">email</td>
	                            <td th:text="${user.createdAt}">created_at</td>
	                            <td th:text="${user.isAgreeEvent()}">agree_event</td>
	                            <td th:text="${user.role}">role</td>
	                            <td>    
	                                <select name="role">
	                                    <option value="USER">USER</option>
	                                    <option value="CAREGIVER">CAREGIVER</option>
	                                </select>
	                            </td>
	                            <td>
	                                <button class="btn btn-outline-dark flex-shrink-0" type="submit">
	                                    업데이트
	                                </button>
	                            </td>
	                        </form> -->
            			</div>
            			<!-- 모달 footer -->
            			<div class="modal-footer">
            				<button type="button" class="btn btn-danger" data-dismiss="modal">취소</button>
            			</div>
            		</div>
            	</div>  
            
            </div>   
        </main>
    </div>
</div>
<script>
	function userModal(id){
		$.ajax({
			type: "get",
			url: "/admin/totUser"+ id,
		})
		.done(function(data){
			$("#viewModalHolder").html(data);
			$("#viewModal").modal("show");
		})
	}
	

</script>
</div>

