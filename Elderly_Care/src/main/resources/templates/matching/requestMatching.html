<!DOCTYPE html>
<html lang="en"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/layout1}"
	>
	
	<!-- 사용자 CSS 추가 -->
<th:block layout:fragment="css">
  <style>
		.caregiver-image img {
		    width: 200px; /* 이미지의 너비 */
		    height: 200px; /* 이미지의 높이 */
		    object-fit: cover; /* 이미지 비율 유지 */
		}
		
        .custom-card-body {
            width: 50%; /* card-body의 너비를 50%로 설정 */
            margin: 0 auto; /* 중앙 정렬 */
        }
		.centered-title {
		    text-align: center;
		}
        textarea {
            width: 100%;
            height: 100px; /* 초기 높이 설정 */
            overflow-y: auto; /* 세로 스크롤 바 활성화 */
        }
  </style>
  <script>
    function submitRequestForm() {
        document.getElementById('matchingRequestForm').submit();
    }
  </script>
</th:block>
	
	<div layout:fragment="content" class="content">
	
	    <h2 class="centered-title mb-4">매칭 요청</h2>

	    <!-- 요양보호사 정보가 있을 경우 표시 -->
	    <div th:if="${caregiver != null}" class="card custom-card-body mb-4">
	        <div class="card-body">
	            <h3 class="card-title">요양보호사 정보</h3>
            <div class="caregiver-image">
			    <img src="@{/img/caregivers/{id}(id=${caregiver.user.userId})}" 
			         onerror="this.onerror=null; this.src=(this.getAttribute('data-gender') === 'male' ? '/img/defaultMale.png' : '/img/defaultFemale.png');" 
			         data-gender="${caregiver.user.gender}"
			         alt="Caregiver Image" />
            </div>
	            <p><strong>이름:</strong> <span th:text="${caregiver.user.name}"></span></p>
	            <p><strong>지역:</strong> <span th:text="${caregiver.user.country}"></span></p>
	            <p><strong>경력:</strong> <span th:text="${caregiver.caregiver.experience}"></span></p>
	            <p><strong>자격증:</strong> <span th:text="${caregiver.caregiver.certification}"></span></p>
	        </div>
	    </div>
	
	    <!-- 매칭 요청 폼 -->
	    <form id="matchingRequestForm" th:action="@{/matching/request}" method="post" class="card custom-card-body mb-4">
			<!-- Senior 정보 입력 폼 -->
			<div class="card-body">
			    <h3 class="card-title">노인 정보 입력</h3>
		        <div class="col-md-4 form-group mb-3">
		            <label for="matchingCountry">지역:</label>
		            <input type="text" class="form-control" id="matchingCountry" name="matchingCountry" placeholder="지역 입력" required>
		        </div>
			    <div class="form-group mb-3">
			        <label for="health">건강 상태:</label>
                    <textarea id="health" name="health" class="form-control" rows="3" placeholder="건강 상태 입력" required></textarea>
			    </div>
			    <div class="form-group mb-3">
			        <label for="requirements">요구 사항:</label>
                    <textarea id="requirements" name="requirements" class="form-control" rows="3" placeholder="요구 사항 입력" required></textarea>
			    </div>
		        <div class="col-md-4 form-group mb-3">
		            <label for="hasGuardian">보호자 유무:</label>
		            <select class="form-select" id="hasGuardian" name="hasGuardian">
		                <option value="true">있음</option>
		                <option value="false" selected>없음</option>
		            </select>
		        </div>
			</div>
    
        <div class="card-body">
            <input type="hidden" name="caregiverId" th:value="${caregiver != null ? caregiver.user.userId : null}" />
            <div class="row">
            </div>
            
            <div class="row mb-3">
                <div class="col">
                    <label for="startDate" class="form-label">시작 날짜</label>
                    <input type="date" id="startDate" name="startDate" class="form-control" required />
                </div>
                <div class="col">
                    <label for="endDate" class="form-label">종료 날짜</label>
                    <input type="date" id="endDate" name="endDate" class="form-control" required />
                </div>
            </div>
            
            <div class="row mb-3">
                <div class="col">
                    <label for="startTime" class="form-label">시작 시간</label>
                    <input type="time" id="startTime" name="startTime" class="form-control" required />
                </div>
                <div class="col">
                    <label for="endTime" class="form-label">종료 시간</label>
                    <input type="time" id="endTime" name="endTime" class="form-control" required />
                </div>
            </div>

		    <!-- 매칭 요청 버튼 -->
		    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#confirmRequestModal">
		      매칭 요청
		    </button>
		
		    <!-- Modal -->
		    <div class="modal fade" id="confirmRequestModal" tabindex="-1" aria-labelledby="confirmRequestLabel" aria-hidden="true">
		      <div class="modal-dialog">
		        <div class="modal-content">
		          <div class="modal-header">
		            <h5 class="modal-title" id="confirmRequestLabel">매칭 요청 확인</h5>
		            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
		          </div>
		          <div class="modal-body">
		            매칭 요청을 하시겠습니까?
		          </div>
		          <div class="modal-footer">
		            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
		            <button type="button" class="btn btn-primary" onclick="submitRequestForm()">확인</button>
		          </div>
		        </div>
		      </div>
		    </div>
        </div>
	    </form>
	
	</div>
</html>